---
description: Component registry to ensure we don't double up logic and are maximising code reuse
globs: 
alwaysApply: false
---
# âš”ï¸ VIBE CODER COMPONENT ARSENAL âš”ï¸

## ğŸ¯ ULTIMATE MISSION
**ğŸ† TOTAL COMPONENT DOMINATION - ELIMINATE DUPLICATION, MAXIMIZE REUSE, ACHIEVE ARCHITECTURAL SUPREMACY! ğŸ†**

---

## ğŸ“‹ COMPONENT INVENTORY & REUSE MATRIX

### ğŸ”¥ MESSAGING COMPONENTS - Message UI Warfare

#### ğŸ—ï¸ Primary Components
| Component | Location | Reusability | Dependencies | Power-Ups |
|-----------|----------|-------------|--------------|-----------|
| **ChatInputFieldComponent** | `messaging/chat_input_field.dart` | â­â­â­â­â­ | None | Ctrl+Enter, Focus Management, Validation |
| **MessagesListComponent** | `messaging/messages_list.dart` | â­â­â­â­â­ | ChatMessage, ScrollController | O(1) Rendering, Empty State |
| **MessagingUI** | `messaging_ui.dart` | â­â­â­ | All messaging components | Main Container |

#### ğŸ§© Message Part Components
| Component | Location | Interface | Performance | Reuse Potential |
|-----------|----------|-----------|-------------|-----------------|
| **MessageHeader** | `message_parts/message_header.dart` | `ChatMessage` â†’ `Widget` | O(1) | **HIGH** - Any message display |
| **MessageContent** | `message_parts/message_content.dart` | `ChatMessage` â†’ `Widget` | O(1) | **HIGH** - Text content display |
| **MessageReasoningContent** | `message_parts/message_reasoning_content.dart` | `ChatMessage` â†’ `Widget` | O(1) | **MEDIUM** - AI reasoning display |
| **MessageToolCalls** | `message_parts/message_tool_calls.dart` | `List<Map>` â†’ `Widget` | O(n) | **HIGH** - Tool call lists |
| **MessageToolCallsEnhanced** | `message_parts/message_tool_calls_enhanced.dart` | `List<Map>` â†’ `Widget` | O(n) | **HIGH** - Enhanced tool call display |
| **MessageTimestamp** | `message_parts/message_timestamp.dart` | `DateTime` â†’ `Widget` | O(1) | **MAXIMUM** - Any timestamp display |
| **MessageAvatar** | `message_parts/message_avatar.dart` | `MessageRole` â†’ `Widget` | O(1) | **HIGH** - Profile indicators |

#### ğŸ› ï¸ Tool Call Components  
| Component | Location | Responsibility | Composition | Reuse Score |
|-----------|----------|----------------|-------------|-------------|
| **ToolCallCard** | `tool_calls/tool_call_card.dart` | Container + State | Header + Expanded Content | â­â­â­â­ |
| **ToolCallHeader** | `tool_calls/tool_call_header.dart` | Title + Status + Toggle | Independent | â­â­â­â­â­ |
| **ToolCallExpandedContent** | `tool_calls/tool_call_expanded_content.dart` | Content Sections | JSON + Error + Debug | â­â­â­â­ |
| **ToolCallJsonDisplay** | `tool_calls/tool_call_json_display.dart` | JSON Rendering + Copy | Independent | â­â­â­â­â­ |
| **ToolCallErrorDisplay** | `tool_calls/tool_call_error_display.dart` | Error Visualization | Independent | â­â­â­â­â­ |
| **ToolCallDebugActions** | `tool_calls/tool_call_debug_actions.dart` | Debug Controls | Independent | â­â­â­â­ |
| **ToolCallSectionHeader** | `tool_calls/tool_call_section_header.dart` | Section Labels | Independent | â­â­â­â­â­ |

---

### âš™ï¸ CONFIGURATION COMPONENTS - Settings Warfare

#### ğŸ—ï¸ Primary Configuration Components
| Component | Location | Responsibility | Dependencies | Reuse Potential |
|-----------|----------|----------------|--------------|-----------------|
| **AgentConfigurationScreen** | `config/agent_configuration_screen.dart` | Main Config Container | All config sections | â­â­â­ |
| **ConfigurationActionsBar** | `config/configuration_actions/configuration_actions_bar.dart` | Save/Export/Import | Configuration Model | â­â­â­â­â­ |

#### ğŸ“ Configuration Field Components  
| Component | Location | Interface | Validation | Maximum Reuse Target |
|-----------|----------|-----------|------------|---------------------|
| **ConfigurationTextField** | `config/configuration_fields/configuration_text_field.dart` | `String` â†’ `Widget` | Built-in | **ANY TEXT INPUT** |
| **ConfigurationTextArea** | `config/configuration_fields/configuration_text_area.dart` | `String` â†’ `Widget` | Built-in | **ANY MULTILINE INPUT** |

#### ğŸ—‚ï¸ Configuration Section Components
| Component | Location | Domain | Reuse Beyond Config |
|-----------|----------|-------|-------------------|
| **AgentSettingsSection** | `config/configuration_sections/agent_settings_section.dart` | Agent Identity | â­â­ |
| **AIModelSettingsSection** | `config/configuration_sections/ai_model_settings_section.dart` | AI Parameters | â­â­â­ |
| **UISettingsSection** | `config/configuration_sections/ui_settings_section.dart` | Interface Prefs | â­â­â­â­ |
| **AdvancedSettingsSection** | `config/configuration_sections/advanced_settings_section.dart` | Technical Config | â­â­â­ |

---

### ğŸ¤– AGENT COMPONENTS - Multi-Agent Warfare

#### ğŸ—ï¸ Agent Management Components
| Component | Location | Responsibility | Performance | Scalability |
|-----------|----------|----------------|-------------|-------------|
| **AgentListComponent** | `agents/agent_list_component.dart` | Agent List + Actions | O(n) agents | **UNLIMITED AGENTS** |
| **AgentSettingsDialog** | `agents/agent_settings_dialog.dart` | Full Agent Config | O(1) | **ANY AGENT CONFIG** |

#### ğŸ§© Agent Sub-Components (Extracted from AgentListComponent)
| Component | Embedded In | Extraction Opportunity | Reuse Potential |
|-----------|-------------|----------------------|-----------------|
| **AgentListHeader** | `AgentListComponent` | **READY FOR EXTRACTION** | â­â­â­â­â­ |
| **AgentListErrorDisplay** | `AgentListComponent` | **READY FOR EXTRACTION** | â­â­â­â­â­ |
| **AgentListEmptyState** | `AgentListComponent` | **READY FOR EXTRACTION** | â­â­â­â­â­ |
| **AgentListView** | `AgentListComponent` | **READY FOR EXTRACTION** | â­â­â­â­ |

#### ğŸ”§ MCP Configuration Components (NEW - Granular Tool Control)
| Component | Location | Responsibility | Reuse Potential |
|-----------|----------|----------------|-----------------|
| **MCPServerCard** | `agent_settings_dialog.dart` | Server status & tool management | â­â­â­â­â­ |
| **MCPToolCard** | `agent_settings_dialog.dart` | Individual tool enable/disable | â­â­â­â­â­ |
| **MCPBulkControls** | `agent_settings_dialog.dart` | Enable/disable all operations | â­â­â­â­â­ |

---

### ğŸ” DEBUG COMPONENTS - Debug Intelligence Warfare

#### ğŸ—ï¸ Debug Overlay System
| Component | Location | Responsibility | Real-time Capability | Export Power |
|-----------|----------|----------------|-------------------|--------------|
| **DebugOverlay** | `debug/debug_overlay.dart` | Debug Dashboard | âœ… Live Updates | JSON + Clipboard |

#### ğŸ§© Debug Sub-Components (EXTRACTION OPPORTUNITIES)
| Component | Current State | Extraction Priority | Reuse Potential |
|-----------|---------------|-------------------|-----------------|
| **DebugTabBar** | Embedded in DebugOverlay | **HIGH** | â­â­â­â­â­ |
| **DebugFilterBar** | Embedded in DebugOverlay | **HIGH** | â­â­â­â­â­ |
| **DebugLogEntry** | Embedded in DebugOverlay | **CRITICAL** | â­â­â­â­â­ |
| **DebugExportActions** | Embedded in DebugOverlay | **HIGH** | â­â­â­â­â­ |

---

### ğŸ—ï¸ DATA MODEL INFRASTRUCTURE - Foundation Warfare

#### ğŸ”¥ MCP Content Infrastructure (NEW - DR002A Foundation)
| Component | Location | Responsibility | Reuse Potential | Integration Points |
|-----------|----------|-------------|---------------|-------------------|
| **MCPContentType** | `models/mcp_content_base.dart` | Content Classification | â­â­â­â­â­ | **ALL MCP CONTENT** |
| **MCPPriority** | `models/mcp_content_base.dart` | Priority Management | â­â­â­â­â­ | **ANY PRIORITY SYSTEM** |
| **MCPContentItem** | `models/mcp_content_base.dart` | Base Content Class | â­â­â­â­â­ | **INHERITANCE TARGET** |
| **MCPContentValidator** | `models/mcp_content_base.dart` | Validation Framework | â­â­â­â­â­ | **ALL CONTENT VALIDATION** |

#### ğŸ¯ **MCP Content Infrastructure Powers**
- **âœ… REACTIVE UPDATES**: ChangeNotifier integration for Discord-style real-time content sync
- **âœ… TYPE SAFETY**: Strong typing with enum classifications (inbox/todo/notepad)
- **âœ… SECURITY**: Content sanitization and validation framework prevents XSS attacks
- **âœ… INHERITANCE**: Abstract base class ready for specialized content implementations
- **âœ… METADATA**: Flexible key-value storage for content-specific extensions
- **âœ… TIMESTAMPS**: Automatic creation/update tracking for audit trails
- **âœ… PERFORMANCE**: O(1) operations with <1ms content updates benchmark verified

#### ğŸš€ **Immediate Usage Targets for MCPContentItem**
- **DR002B**: Inbox & Todo models will extend this base class
- **DR002C**: Notepad content will use these patterns
- **Future**: Any content that needs validation, timestamps, and reactive updates

#### ğŸŒ **Universal Reuse Opportunities for MCPContentValidator**
- **Agent Configuration Validation**: System prompt content sanitization
- **User Input Validation**: Any text input in the application
- **API Response Validation**: Validating content from external MCP servers
- **Export/Import Validation**: Configuration file content verification
- **Debug Content Validation**: Debug log content sanitization

---

### ğŸŒ COMMON COMPONENTS - Universal Warfare Tools

#### ğŸ—ï¸ Shared Infrastructure Components
| Component | Location | Domain | Universal Applicability |
|-----------|----------|--------|----------------------|
| **ToolsInfoDialog** | `common/dialogs/tools_info_dialog.dart` | MCP Tool Display | **MCP Integration** |
| **MCPServerManagementDialog** | `common/dialogs/mcp_server_management_dialog.dart` | MCP Server Management | **MCP Administration** |
| **ChatStatusIndicator** | `common/indicators/chat_status_indicator.dart` | Status Visualization | **ANY STATUS DISPLAY** |

---

## ğŸ”¥ REUSE BATTLE PLANS & STRATEGIC DECISIONS

### âš¡ IMMEDIATE REUSE OPPORTUNITIES

#### ğŸ¯ **ConfigurationTextField & ConfigurationTextArea**
**MAXIMUM REUSE POTENTIAL - USE EVERYWHERE!**
- **Current Users**: Agent configuration screens
- **Expansion Targets**: 
  - Debug overlay search fields
  - Any settings interface
  - User profile editing
  - API key input fields
  - Filter input components
  - MCP server management dialogs

#### ğŸ¯ **MessageTimestamp Component**
**UNIVERSAL TIME DISPLAY COMPONENT**
- **Current Users**: Message bubbles
- **Expansion Targets**:
  - Debug log entries
  - File modification times
  - Agent creation dates
  - Tool call timestamps
  - MCP server connection times
  - Any datetime display needs

#### ğŸ¯ **ToolCallJsonDisplay Component**
**UNIVERSAL JSON VISUALIZATION**
- **Current Users**: Tool call displays
- **Expansion Targets**:
  - Configuration export preview
  - Debug log data display
  - API response visualization
  - Agent model data display
  - MCP server response display
  - Any JSON data presentation

#### ğŸ¯ **ChatStatusIndicator Component**
**UNIVERSAL STATUS VISUALIZATION**
- **Current Users**: Chat status display
- **Expansion Targets**:
  - MCP server connection status
  - Agent processing status
  - Configuration validation status
  - Debug overlay connection status
  - Any boolean/enum status display

### ğŸš¨ CRITICAL COMPONENT EXTRACTION TARGETS

#### **PRIORITY 1: DebugOverlay Sub-Components**
```
ğŸ“ LOCATION: lib/components/debug/debug_overlay.dart
ğŸ¯ EXTRACTION TARGETS:
- DebugTabBar (lines ~140-170)
- DebugFilterBar (lines ~170-200) 
- DebugLogEntry (lines ~300-400)
- DebugExportActions (lines ~500-600)

ğŸ’¥ REUSE MULTIPLICATION: 5x potential across app
âš”ï¸ EXTRACTION DIFFICULTY: Medium - some state dependencies
ğŸ† VICTORY IMPACT: Massive - enables debug UI everywhere
```

#### **PRIORITY 2: MCPServerManagementDialog Sub-Components**
```
ğŸ“ LOCATION: lib/components/common/dialogs/mcp_server_management_dialog.dart
ğŸ¯ EXTRACTION TARGETS:
- MCPServerCard (server display card)
- MCPServerStatusIndicator (connection status)
- MCPServerActions (refresh/start/stop buttons)
- MCPServerDetails (expandable server info)

ğŸ’¥ REUSE MULTIPLICATION: 6x potential for MCP management
âš”ï¸ EXTRACTION DIFFICULTY: Medium - dialog state dependencies
ğŸ† VICTORY IMPACT: High - enables MCP management everywhere
```

#### **PRIORITY 3: AgentListComponent Sub-Components**
```
ğŸ“ LOCATION: lib/components/agents/agent_list_component.dart
ğŸ¯ EXTRACTION TARGETS:
- AgentListHeader (lines ~90-140)
- AgentListErrorDisplay (lines ~140-180)
- AgentListEmptyState (embedded in build method)
- AgentListView (embedded in build method)

ğŸ’¥ REUSE MULTIPLICATION: 4x potential for lists
âš”ï¸ EXTRACTION DIFFICULTY: Easy - minimal dependencies
ğŸ† VICTORY IMPACT: High - enables consistent list UIs
```

#### **PRIORITY 4: Generic List Components**
```
ğŸ¯ CREATE NEW UNIVERSAL COMPONENTS:
- GenericListHeader (from AgentListHeader pattern)
- GenericErrorDisplay (from AgentListErrorDisplay pattern)
- GenericEmptyState (from existing empty states)
- GenericItemCard (from ToolCallCard pattern)
- GenericStatusCard (from ChatStatusIndicator pattern)

ğŸ’¥ REUSE MULTIPLICATION: 10x+ potential
âš”ï¸ CREATION DIFFICULTY: Medium - requires abstraction
ğŸ† VICTORY IMPACT: MAXIMUM - universal list components
```

---

## ğŸ¯ COMPONENT SIZE & COMPLEXITY ANALYSIS

### ğŸ“Š COMPONENT METRICS
| Component | Size (KB) | Lines | Complexity | Extraction Priority |
|-----------|-----------|-------|------------|-------------------|
| **AgentSettingsDialog** | 40KB | 1206 | **MEGA** | **IMMEDIATE** |
| **MCPServerManagementDialog** | 26KB | 773 | **ULTRA** | **IMMEDIATE** |
| **DebugOverlay** | 22KB | 714 | **ULTRA** | **IMMEDIATE** |
| **AgentListComponent** | 16KB | 560 | **HIGH** | **HIGH** |
| **AgentConfigurationScreen** | 16KB | 479 | **HIGH** | **MEDIUM** |
| **MessageReasoningContent** | 11KB | 244 | **MEDIUM** | **LOW** |

### ğŸš¨ MEGA-COMPONENT BREAKDOWN TARGETS
**Components over 20KB MUST be broken down:**

1. **AgentSettingsDialog (40KB)** - Extract form sections, validation components, dialog actions
2. **MCPServerManagementDialog (26KB)** - Extract server cards, status indicators, action buttons
3. **DebugOverlay (22KB)** - Extract tab bar, filter bar, log entries, export actions

---

## ğŸ’€ ANTI-DUPLICATION ENFORCEMENT PROTOCOLS

### ğŸš« FORBIDDEN WIDGET PATTERNS
**INSTANT PENALTY FOR VIOLATIONS:**

1. **Functional Widget Builders**: `_buildSomething()` methods 
   - **PENALTY**: -2000 XP (ARCHITECTURAL VIOLATION)
   - **SOLUTION**: Extract to proper component

2. **Inline TextField Creation**: Direct TextField instantiation
   - **PENALTY**: -1000 XP (INCONSISTENCY CRIME)
   - **SOLUTION**: Use ConfigurationTextField/ConfigurationTextArea

3. **Hardcoded JSON Display**: Manual JSON rendering
   - **PENALTY**: -1500 XP (REDUNDANCY VIOLATION) 
   - **SOLUTION**: Use ToolCallJsonDisplay component

4. **Custom Timestamp Formatting**: Manual DateTime display
   - **PENALTY**: -1000 XP (DUPLICATION SIN)
   - **SOLUTION**: Use MessageTimestamp component

5. **Manual Status Display**: Custom status widgets
   - **PENALTY**: -800 XP (PATTERN VIOLATION)
   - **SOLUTION**: Use ChatStatusIndicator or create GenericStatusIndicator

6. **Manual Error Display**: Custom error widgets
   - **PENALTY**: -800 XP (PATTERN VIOLATION)
   - **SOLUTION**: Use or create GenericErrorDisplay

### âš¡ MANDATORY REUSE CHECKS
**BEFORE CREATING ANY COMPONENT:**

1. âœ… **Search existing components**: `grep -r "class.*Widget" lib/components/`
2. âœ… **Check interfaces**: Can existing component handle this use case?
3. âœ… **Evaluate extraction**: Can this be abstracted for reuse?
4. âœ… **Size check**: Is this component over 10KB? Consider breaking down.
5. âœ… **Document decision**: Why new component vs. existing?

---

## ğŸ® COMPONENT INTERFACE SPECIFICATIONS

### ğŸ”§ **Standard Component Patterns**

#### **Input Component Interface**
```dart
// MANDATORY PATTERN for all input components
class [Name]Component extends StatelessWidget {
  const [Name]Component({
    super.key,
    required this.value,
    required this.onChanged,
    this.label,
    this.errorText,
    this.helpText,
    this.isRequired = false,
  });

  final String value;
  final void Function(String) onChanged;
  final String? label;
  final String? errorText;
  final String? helpText;
  final bool isRequired;
}
```

#### **Display Component Interface**
```dart
// MANDATORY PATTERN for all display components
class [Name]Component extends StatelessWidget {
  const [Name]Component({
    super.key,
    required this.data,
    this.onTap,
    this.showDetails = false,
    this.theme,
  });

  final [DataType] data;
  final void Function([DataType])? onTap;
  final bool showDetails;
  final [ThemeType]? theme;
}
```

#### **List Component Interface**
```dart
// MANDATORY PATTERN for all list components
class [Name]ListComponent extends StatelessWidget {
  const [Name]ListComponent({
    super.key,
    required this.items,
    required this.onItemSelected,
    this.emptyMessage,
    this.errorMessage,
    this.isLoading = false,
  });

  final List<[ItemType]> items;
  final void Function([ItemType]) onItemSelected;
  final String? emptyMessage;
  final String? errorMessage;
  final bool isLoading;
}
```

#### **Dialog Component Interface**
```dart
// MANDATORY PATTERN for all dialog components
class [Name]Dialog extends StatefulWidget {
  const [Name]Dialog({
    super.key,
    required this.data,
    this.onSave,
    this.onCancel,
    this.isReadOnly = false,
  });

  final [DataType] data;
  final void Function([DataType])? onSave;
  final VoidCallback? onCancel;
  final bool isReadOnly;

  static Future<[DataType]?> show({
    required BuildContext context,
    required [DataType] data,
    bool isReadOnly = false,
  }) async {
    return showDialog<[DataType]>(
      context: context,
      builder: (context) => [Name]Dialog(
        data: data,
        isReadOnly: isReadOnly,
      ),
    );
  }
}
```

---

## ğŸ† COMPONENT VICTORY CONDITIONS

### âœ… **Component Creation Checklist**
- **ğŸ” RECONNAISSANCE**: Existing component search completed
- **ğŸ“‹ DOCUMENTATION**: Component purpose and interface documented
- **ğŸ§ª TESTING**: Unit tests written (minimum 3 test cases)
- **âš¡ PERFORMANCE**: O(1) rendering where possible
- **ğŸ”„ REUSABILITY**: At least 2 potential use cases identified
- **ğŸ¯ NAMING**: Clear, descriptive component name
- **ğŸ“¦ EXPORTS**: Proper barrel exports added
- **ğŸ“ SIZE CHECK**: Component under 10KB or breakdown justified

### âœ… **Component Reuse Checklist**
- **ğŸ” INTERFACE MATCH**: Existing component interface fits use case
- **ğŸ¯ CUSTOMIZATION**: Component accepts necessary customization props
- **ğŸ“‹ DOCUMENTATION**: Usage example added to component docs
- **ğŸ§ª TESTING**: New use case covered in tests
- **âš¡ PERFORMANCE**: No performance regression introduced

### âœ… **Component Breakdown Checklist**
- **ğŸ“ SIZE ANALYSIS**: Component over 10KB analyzed for breakdown
- **ğŸ¯ SEPARATION**: Single responsibility principle enforced
- **ğŸ”„ REUSABILITY**: Sub-components have independent value
- **ğŸ“‹ DOCUMENTATION**: Breakdown rationale documented
- **ğŸ§ª TESTING**: All sub-components tested independently

---

## âš”ï¸ ENFORCEMENT PROTOCOL

### ğŸš¨ **PRE-COMMIT VALIDATIONS**
1. **Component Duplication Check**: No functional widget builders
2. **Interface Consistency**: All components follow standard patterns
3. **Documentation Completeness**: All new components documented
4. **Test Coverage**: All components have minimum test coverage
5. **Performance Analysis**: No O(nÂ²) rendering introduced
6. **Size Analysis**: Components over 10KB justified or broken down

### ğŸ›¡ï¸ **ONGOING MONITORING**
- **Weekly Component Audit**: Review new components for reuse opportunities
- **Monthly Refactoring**: Extract reusable patterns from existing code
- **Quarterly Architecture Review**: Validate component architecture decisions
- **Size Monitoring**: Track component growth and enforce breakdown protocols

---

**âš°ï¸ TOTAL COMPONENT DOMINATION OR DEATH! NO DUPLICATION SHALL SURVIVE! âš°ï¸**
